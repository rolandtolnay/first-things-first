---
phase: 03-role-management
plan: 02
type: execute
wave: 2
depends_on: ["03-01"]
files_modified:
  - src/components/sidebar/RoleList.tsx
  - src/components/sidebar/Sidebar.tsx
autonomous: false

must_haves:
  truths:
    - "User sees list of roles in sidebar"
    - "User can create a new role and see it appear"
    - "User can edit role name inline"
    - "User can delete role"
    - "Each role shows distinct color from palette"
    - "Roles persist across page refresh"
  artifacts:
    - path: "src/components/sidebar/RoleList.tsx"
      provides: "Role list container rendering sorted roles"
      min_lines: 30
    - path: "src/components/sidebar/Sidebar.tsx"
      provides: "Sidebar with integrated role list"
      contains: "RoleList"
  key_links:
    - from: "RoleList.tsx"
      to: "weekStore selectSortedRoles"
      via: "useWeekStore with selector"
      pattern: "useWeekStore.*selectSortedRoles"
    - from: "RoleList.tsx"
      to: "RoleItem component"
      via: "import and render"
      pattern: "import.*RoleItem"
    - from: "Sidebar.tsx"
      to: "RoleList component"
      via: "import and render"
      pattern: "import.*RoleList"
---

<objective>
Integrate role components into sidebar with store connection.

Purpose: Wire the RoleItem and AddRoleButton components into a RoleList, connect to the weekStore for data, and integrate into the Sidebar. This completes the role management UI.

Output: RoleList component, updated Sidebar with role management
</objective>

<execution_context>
@~/.claude/get-shit-done/workflows/execute-plan.md
@~/.claude/get-shit-done/templates/summary.md
@~/.claude/get-shit-done/references/checkpoints.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/STATE.md

@.planning/phases/03-role-management/03-01-SUMMARY.md

@src/types/index.ts
@src/stores/weekStore.ts
@src/components/sidebar/Sidebar.tsx
</context>

<tasks>

<task type="auto">
  <name>Task 1: Create RoleList component</name>
  <files>src/components/sidebar/RoleList.tsx</files>
  <action>
    Create a client component that:

    1. Fetches roles from weekStore using selectSortedRoles selector
    2. Renders RoleItem for each role
    3. Includes AddRoleButton at the bottom
    4. Handles empty state gracefully

    Structure:
    ```
    <div className="space-y-1">
      {roles.map(role => <RoleItem key={role.id} role={role} />)}
      <AddRoleButton />
    </div>
    ```

    Store connection:
    - Import useWeekStore and selectSortedRoles from @/stores/weekStore
    - Use: const roles = useWeekStore(selectSortedRoles)

    Empty state:
    - If no roles and no currentWeek loading, show helpful message
    - "No roles yet. Add your first role below."
    - Muted text, centered

    Styling:
    - Container: flex flex-col
    - Role items have small vertical spacing (space-y-1)
    - AddRoleButton appears below the list

    Add 'use client' directive.
  </action>
  <verify>TypeScript compiles: npx tsc --noEmit</verify>
  <done>RoleList renders sorted roles from store with add button</done>
</task>

<task type="auto">
  <name>Task 2: Wire RoleList into Sidebar</name>
  <files>src/components/sidebar/Sidebar.tsx</files>
  <action>
    Update Sidebar to include RoleList:

    1. Import RoleList component
    2. Replace placeholder content with RoleList
    3. Add section header "Roles" above the list

    Updated structure:
    ```
    <div className="flex flex-col h-full">
      <header>...</header>
      <div className="flex-1 p-4 overflow-y-auto">
        <h2 className="text-sm font-medium text-muted-foreground mb-3">Roles</h2>
        <RoleList />
      </div>
    </div>
    ```

    Keep existing header with ThemeToggle.
    Remove the placeholder paragraph text.

    Styling for section header:
    - text-sm font-medium text-muted-foreground mb-3
    - Uppercase tracking-wide optional for more distinction
  </action>
  <verify>TypeScript compiles: npx tsc --noEmit</verify>
  <done>Sidebar displays RoleList with section header</done>
</task>

<task type="checkpoint:human-verify" gate="blocking">
  <what-built>Complete role management UI in sidebar</what-built>
  <how-to-verify>
    1. Run: npm run dev
    2. Visit: http://localhost:3000
    3. Look at the sidebar on the left
    4. Test creating a role:
       - Click "+ Add Role" at bottom of sidebar
       - Type a role name (e.g., "Work")
       - Press Enter
       - Verify: Role appears with a colored dot
    5. Test creating more roles:
       - Add 2-3 more roles (e.g., "Family", "Health")
       - Verify: Each gets a different color (teal, violet, orange...)
    6. Test editing a role:
       - Double-click or click on a role name
       - Change the name
       - Press Enter or click away
       - Verify: Name updates
    7. Test deleting a role:
       - Hover over a role
       - Click the X/delete button
       - Confirm deletion in dialog
       - Verify: Role disappears
    8. Test persistence:
       - Refresh the page
       - Verify: All roles still appear with correct colors
    9. Check both themes:
       - Toggle dark/light mode
       - Verify: Role colors visible in both modes
  </how-to-verify>
  <resume-signal>Type "approved" to continue, or describe any issues</resume-signal>
</task>

</tasks>

<verification>
Before declaring plan complete:
- [ ] `npx tsc --noEmit` passes without errors
- [ ] `npm run build` succeeds
- [ ] Roles display in sidebar with colors
- [ ] Create, edit, delete all work
- [ ] Data persists across refresh
- [ ] Human verification passed
</verification>

<success_criteria>

- All tasks completed
- All verification checks pass
- Human approved the role management UI
- ROLE-01 through ROLE-05 requirements satisfied
- DSGN-02 partially satisfied (roles have colors)
</success_criteria>

<output>
After completion, create `.planning/phases/03-role-management/03-02-SUMMARY.md`
</output>
