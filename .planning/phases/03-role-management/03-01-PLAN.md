---
phase: 03-role-management
plan: 01
type: execute
wave: 1
depends_on: []
files_modified:
  - src/lib/role-colors.ts
  - src/components/sidebar/RoleItem.tsx
  - src/components/sidebar/AddRoleButton.tsx
autonomous: true

must_haves:
  truths:
    - "Role color maps correctly to Tailwind CSS variable"
    - "RoleItem displays role name with color indicator"
    - "RoleItem allows inline name editing"
    - "RoleItem has delete functionality"
    - "AddRoleButton captures role name input"
    - "AddRoleButton calls store addRole action"
  artifacts:
    - path: "src/lib/role-colors.ts"
      provides: "RoleColor to Tailwind class mapping"
      exports: ["getRoleColorClass", "getRoleColorStyle"]
    - path: "src/components/sidebar/RoleItem.tsx"
      provides: "Individual role display with edit/delete"
      min_lines: 50
    - path: "src/components/sidebar/AddRoleButton.tsx"
      provides: "New role creation form"
      min_lines: 30
  key_links:
    - from: "RoleItem.tsx"
      to: "weekStore updateRole/deleteRole"
      via: "useWeekStore hook calls"
      pattern: "useWeekStore.*updateRole|deleteRole"
    - from: "AddRoleButton.tsx"
      to: "weekStore addRole"
      via: "useWeekStore hook call"
      pattern: "useWeekStore.*addRole"
    - from: "RoleItem.tsx"
      to: "role-colors.ts"
      via: "color class import"
      pattern: "import.*getRoleColorClass"
---

<objective>
Create role item components with color display, inline editing, and deletion.

Purpose: Build the individual role UI components that will be composed into the RoleList. Each role needs to display its color, allow name editing, and support deletion.

Output: Three files - color utility, RoleItem component, AddRoleButton component
</objective>

<execution_context>
@~/.claude/get-shit-done/workflows/execute-plan.md
@~/.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/STATE.md

@src/types/index.ts
@src/stores/weekStore.ts
@src/app/globals.css
</context>

<tasks>

<task type="auto">
  <name>Task 1: Create role color utility</name>
  <files>src/lib/role-colors.ts</files>
  <action>
    Create utility functions to map RoleColor type to Tailwind classes.

    The RoleColor type has 8 values: teal, amber, rose, violet, emerald, orange, sky, fuchsia.
    The CSS variables in globals.css use --role-1 through --role-8 naming.

    Create mapping:
    - teal → role-1
    - violet → role-2
    - orange → role-3
    - sky → role-4 (maps to cyan CSS var)
    - rose → role-5
    - emerald → role-6 (maps to green CSS var)
    - amber → role-7
    - fuchsia → role-8 (maps to slate CSS var - note: fuchsia not in CSS, use slate)

    Export two functions:
    1. getRoleColorClass(color: RoleColor): string - returns Tailwind class like "bg-role-1"
    2. getRoleColorStyle(color: RoleColor): string - returns inline style for border/text use

    Note: The Tailwind theme has --color-role-N defined, so classes like bg-role-1, text-role-1, border-role-1 work.
  </action>
  <verify>TypeScript compiles without errors: npx tsc --noEmit</verify>
  <done>Color utility functions exported and type-safe</done>
</task>

<task type="auto">
  <name>Task 2: Create RoleItem component</name>
  <files>src/components/sidebar/RoleItem.tsx</files>
  <action>
    Create a client component for displaying a single role with:

    Props: role: Role

    Structure:
    - Color indicator (small colored dot/badge using getRoleColorClass)
    - Role name (editable on click/double-click)
    - Delete button (X icon, appears on hover)

    Behavior:
    - Display mode: Show color dot + name + hover delete button
    - Edit mode: Input field replaces name, save on Enter/blur, cancel on Escape
    - Delete: Confirm with window.confirm(), call deleteRole from weekStore
    - Edit: Call updateRole from weekStore with new name

    Styling:
    - Compact row layout (flex, items-center, gap-2)
    - Color dot: w-3 h-3 rounded-full with role color background
    - Name: text-sm, text-foreground
    - Delete button: text-muted-foreground hover:text-destructive, opacity-0 group-hover:opacity-100
    - Edit input: minimal border, focus ring, same size as name text

    Use useState for edit mode, useWeekStore for store actions.
    Add 'use client' directive.
  </action>
  <verify>TypeScript compiles: npx tsc --noEmit</verify>
  <done>RoleItem component renders role with color, supports inline edit and delete</done>
</task>

<task type="auto">
  <name>Task 3: Create AddRoleButton component</name>
  <files>src/components/sidebar/AddRoleButton.tsx</files>
  <action>
    Create a client component for adding new roles:

    Two states:
    1. Button state: Shows "+ Add Role" button
    2. Input state: Shows text input with save/cancel

    Behavior:
    - Click button → switch to input state, auto-focus input
    - Enter in input → create role if name not empty, reset to button state
    - Escape in input → cancel, reset to button state
    - Blur on input → create if name not empty, else cancel
    - Empty name → don't create, just cancel

    Store interaction:
    - Import useWeekStore
    - Call addRole({ name: inputValue }) on submit
    - addRole returns the created Role (color auto-assigned by store)

    Styling:
    - Button: w-full, text-left, text-sm, text-muted-foreground, hover:text-foreground
    - Plus icon before text (can use + character or simple SVG)
    - Input: w-full, text-sm, border border-border rounded px-2 py-1
    - Container: py-2 border-t border-border mt-2

    Use useState for input mode and input value.
    Add 'use client' directive.
  </action>
  <verify>TypeScript compiles: npx tsc --noEmit</verify>
  <done>AddRoleButton component allows creating new roles with name input</done>
</task>

</tasks>

<verification>
Before declaring plan complete:
- [ ] `npx tsc --noEmit` passes without errors
- [ ] `npm run build` succeeds
- [ ] All three files exist and export expected items
- [ ] No ESLint errors in new files
</verification>

<success_criteria>

- All tasks completed
- All verification checks pass
- Color utility correctly maps all 8 RoleColor values
- RoleItem has edit and delete functionality wired to store
- AddRoleButton creates roles via store
</success_criteria>

<output>
After completion, create `.planning/phases/03-role-management/03-01-SUMMARY.md`
</output>
