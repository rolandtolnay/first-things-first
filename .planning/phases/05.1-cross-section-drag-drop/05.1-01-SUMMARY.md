---
phase: 05.1
plan: 01
subsystem: drag-drop
tags: [dnd-kit, draggable, priority, evening]

dependency-graph:
  requires: [05-01, 05-02, 05-03]
  provides: [PriorityDragData, EveningDragData, draggable-priorities, draggable-evening-blocks]
  affects: [05.1-02, 05.1-03]

tech-stack:
  added: []
  patterns: [inner-draggable-component, satisfies-type-guard]

key-files:
  created: []
  modified:
    - src/types/dnd.ts
    - src/components/calendar/PriorityItem.tsx
    - src/components/calendar/DayPriorities.tsx
    - src/components/calendar/EveningSlot.tsx
    - src/components/dnd/DragOverlayContent.tsx

decisions:
  - key: inner-draggable-pattern
    choice: Separate DraggableEveningBlock component inside EveningSlot
    reason: Keeps outer container droppable while inner block is draggable

metrics:
  duration: ~4 min
  completed: 2026-01-18
---

# Phase 5.1 Plan 01: Make Priorities and Evening Blocks Draggable - Summary

Extended dnd types with PriorityDragData and EveningDragData, made PriorityItem and EveningSlot blocks draggable with grab cursors and visual previews.

## What Was Built

### 1. Extended Drag Data Types (src/types/dnd.ts)
- Added `PriorityDragData` interface for draggable priority items
- Added `EveningDragData` interface for draggable evening blocks
- Updated `DragData` union to include all four draggable types: goal, block, priority, evening

### 2. Draggable Priority Items (PriorityItem.tsx)
- Integrated `useDraggable` hook from dnd-kit
- Created drag data with `satisfies` type guard for type safety
- Added `cursor-grab` / `active:cursor-grabbing` classes
- Added `opacity-50` when dragging for visual feedback
- Updated DayPriorities.tsx to pass `dayIndex` prop

### 3. Draggable Evening Blocks (EveningSlot.tsx)
- Created inner `DraggableEveningBlock` component
- Outer container remains droppable for goal drops
- Inner block is draggable for cross-section movement
- Added grab cursor and opacity feedback

### 4. DragOverlay Support (DragOverlayContent.tsx)
- Added `PriorityOverlay` component - compact style with left border color
- Added `EveningOverlay` component - role color background with opacity
- Extended main component to handle all four drag types

## Commits

| Hash | Type | Description |
|------|------|-------------|
| 3f77752 | feat | Extend drag data types for priority and evening items |
| e5bdff3 | feat | Make PriorityItem draggable |
| 538c665 | feat | Make evening block draggable |
| 5ed42c8 | feat | Add DragOverlay support for priority and evening items |

## Deviations from Plan

None - plan executed exactly as written.

## Verification Results

- [x] `npx tsc --noEmit` passes
- [x] `npm run build` succeeds
- [x] All drag data types properly exported
- [x] PriorityItem shows grab cursor and is draggable
- [x] Evening blocks show grab cursor and are draggable
- [x] DragOverlay renders correct previews for all item types

## Next Phase Readiness

Ready for Plan 05.1-02 (Drop Handling for Cross-Section Moves):
- All four item types now draggable
- Drag data includes source information for move logic
- Drop zones already configured from Phase 5
- Need to implement handleDragEnd logic for cross-section moves
