---
phase: 04-goal-management
plan: 01
type: execute
wave: 1
depends_on: []
files_modified:
  - src/components/sidebar/GoalItem.tsx
  - src/components/sidebar/AddGoalButton.tsx
autonomous: true

must_haves:
  truths:
    - "User can see goal text displayed under its role"
    - "User can edit a goal's text via double-click"
    - "User can delete a goal with confirmation"
  artifacts:
    - path: "src/components/sidebar/GoalItem.tsx"
      provides: "Individual goal display with edit/delete"
      min_lines: 80
    - path: "src/components/sidebar/AddGoalButton.tsx"
      provides: "Goal creation input"
      min_lines: 40
  key_links:
    - from: "GoalItem.tsx"
      to: "weekStore.updateGoal"
      via: "edit handler"
      pattern: "updateGoal\\("
    - from: "GoalItem.tsx"
      to: "weekStore.deleteGoal"
      via: "delete handler"
      pattern: "deleteGoal\\("
    - from: "AddGoalButton.tsx"
      to: "weekStore.addGoal"
      via: "submit handler"
      pattern: "addGoal\\("
---

<objective>
Create goal item components for displaying and managing individual goals within roles.

Purpose: Enable goal CRUD operations in the sidebar following established RoleItem patterns.
Output: GoalItem and AddGoalButton components ready for composition in GoalList.
</objective>

<execution_context>
@~/.claude/get-shit-done/workflows/execute-plan.md
@~/.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/STATE.md
@.planning/phases/03-role-management/03-01-SUMMARY.md

# Existing patterns to follow:
@src/components/sidebar/RoleItem.tsx
@src/components/sidebar/AddRoleButton.tsx

# Store operations already implemented:
@src/stores/weekStore.ts

# Types for Goal:
@src/types/index.ts
</context>

<tasks>

<task type="auto">
  <name>Task 1: Create GoalItem component</name>
  <files>src/components/sidebar/GoalItem.tsx</files>
  <action>
Create GoalItem component following RoleItem patterns:

1. Props: `goal: Goal` and `roleColor: RoleColor` (for color coding)
2. Display: Goal text with role color accent (left border or small dot)
3. Edit mode: Double-click to edit text, Enter to save, Escape to cancel
4. Delete: X button on hover with confirmation dialog
5. Notes indicator: Small icon if goal.notes exists (optional visual cue)

Wire to store:
- `updateGoal(goal.id, { text })` on save
- `deleteGoal(goal.id)` on delete confirmation

Follow existing patterns:
- Use useState for isEditing, editValue
- Use useRef for input focus
- useEffect for focus on edit mode entry
- Inline styles for role color (Tailwind v4 purges dynamic classes)

Use getRoleColorStyle from @/lib/role-colors for color.
  </action>
  <verify>npx tsc --noEmit passes</verify>
  <done>GoalItem displays goal, supports double-click edit, and delete with confirmation</done>
</task>

<task type="auto">
  <name>Task 2: Create AddGoalButton component</name>
  <files>src/components/sidebar/AddGoalButton.tsx</files>
  <action>
Create AddGoalButton component following AddRoleButton patterns:

1. Props: `roleId: string` (to associate new goal with role)
2. Two-state pattern:
   - Button mode: Shows "+ Add Goal" (smaller, fits under role goals)
   - Input mode: Text input for goal text
3. Behavior:
   - Click button -> input mode, auto-focus
   - Enter -> submit if not empty, reset to button mode
   - Escape -> cancel, reset to button mode
   - Blur -> submit if has value, else cancel
4. Calls `addGoal({ roleId, text })` on submit

Keep styling compact since it sits within each role section.
  </action>
  <verify>npx tsc --noEmit passes</verify>
  <done>AddGoalButton shows input on click, creates goal on Enter, resets on completion</done>
</task>

</tasks>

<verification>
Before declaring plan complete:
- [ ] `npx tsc --noEmit` passes
- [ ] `npm run build` succeeds
- [ ] Both components export from their files
- [ ] No ESLint errors
</verification>

<success_criteria>

- GoalItem and AddGoalButton components created
- GoalItem supports: display, double-click edit, delete with confirmation
- AddGoalButton supports: two-state (button/input), goal creation
- Both components wired to weekStore actions
- All verification checks pass
</success_criteria>

<output>
After completion, create `.planning/phases/04-goal-management/04-01-SUMMARY.md`
</output>
